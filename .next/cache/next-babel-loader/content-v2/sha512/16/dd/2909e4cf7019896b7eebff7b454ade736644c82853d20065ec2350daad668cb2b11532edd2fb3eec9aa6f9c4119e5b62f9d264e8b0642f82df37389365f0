{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\proyectos\\\\next\\\\seani\\\\components\\\\Reloj\\\\RelojLimit.jsx\";\nimport React, { useState, useEffect } from \"react\";\nimport io from \"socket.io-client\";\nimport { useSnackbar } from \"notistack\";\nimport { useDispatch } from 'react-redux';\nimport { accionTime } from '../../redux/accion';\nimport AccessAlarmIcon from \"@material-ui/icons/AccessAlarm\";\nimport { allCancel } from '../../utils/api';\n\nfunction RelojLimit({\n  user,\n  alumno\n}) {\n  const {\n    0: sock,\n    1: setSock\n  } = useState(null);\n  useEffect(() => {\n    fetch(\"/api/socket\");\n    const socket = io();\n    socket.on(\"connect\", () => {\n      console.log(`user ${user.uid} connect`);\n    });\n    setSock(socket);\n    return () => socket.on(\"disconnect\", () => {\n      console.log(`user ${user.uid} disconnect`);\n    });\n  }, []);\n  return /*#__PURE__*/_jsxDEV(TimerInternal, {\n    socket: sock,\n    user: user,\n    alumno: alumno\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 25,\n    columnNumber: 10\n  }, this);\n}\n\nfunction TimerInternal({\n  socket,\n  user,\n  alumno\n}) {\n  var _alumno$data;\n\n  const dispatch = useDispatch();\n  const {\n    enqueueSnackbar\n  } = useSnackbar();\n  const {\n    0: seconds,\n    1: setSeconds\n  } = useState(alumno === null || alumno === void 0 ? void 0 : (_alumno$data = alumno.data) === null || _alumno$data === void 0 ? void 0 : _alumno$data.time);\n  const {\n    0: timer,\n    1: setTimer\n  } = useState({\n    h: null,\n    m: null,\n    s: null\n  });\n  useEffect(() => {\n    let interval = null;\n\n    if (seconds === 900) {\n      enqueueSnackbar(\"Quedan 15 minutos para finalizar\", {\n        variant: \"warning\"\n      });\n    }\n\n    if (seconds === 0) {\n      enqueueSnackbar(\"El tiempo para realizar tu examen finalizo\", {\n        variant: \"info\"\n      });\n      setSeconds(0);\n      dispatch(accionTime(0));\n      setTimer({\n        s: 0,\n        h: 0,\n        m: 0\n      });\n      socket === null || socket === void 0 ? void 0 : socket.emit(\"message\", {\n        id: user.uid,\n        time: seconds\n      });\n      allCancel({\n        id: user === null || user === void 0 ? void 0 : user.uid\n      }).then(() => {\n        window.location.replace('/home');\n      });\n    } else {\n      interval = setInterval(() => {\n        setSeconds(seconds => seconds - 1);\n      }, 1000);\n      dispatch(accionTime(seconds));\n      setTimer({\n        s: Math.round(seconds % 0x3c),\n        h: Math.floor(seconds / 0xe10),\n        m: Math.floor(seconds / 0x3c) % 0x3c\n      });\n      socket === null || socket === void 0 ? void 0 : socket.emit(\"message\", {\n        id: user.uid,\n        time: seconds\n      });\n    }\n\n    return () => clearInterval(interval);\n  }, [seconds]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(AccessAlarmIcon, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this), `${timer.h}H ${timer.m} M ${timer.s}S`]\n  }, void 0, true);\n}\n\nexport default RelojLimit;","map":{"version":3,"sources":["C:/proyectos/next/seani/components/Reloj/RelojLimit.jsx"],"names":["React","useState","useEffect","io","useSnackbar","useDispatch","accionTime","AccessAlarmIcon","allCancel","RelojLimit","user","alumno","sock","setSock","fetch","socket","on","console","log","uid","TimerInternal","dispatch","enqueueSnackbar","seconds","setSeconds","data","time","timer","setTimer","h","m","s","interval","variant","emit","id","then","window","location","replace","setInterval","Math","round","floor","clearInterval"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport io from \"socket.io-client\";\r\nimport { useSnackbar } from \"notistack\";\r\nimport {useDispatch} from 'react-redux'\r\nimport {accionTime} from '../../redux/accion'\r\nimport AccessAlarmIcon from \"@material-ui/icons/AccessAlarm\";\r\nimport {allCancel} from '../../utils/api';\r\n\r\n\r\n\r\nfunction RelojLimit({ user,alumno }) {\r\n  const [sock, setSock] = useState(null);\r\n  useEffect(() => {\r\n    fetch(\"/api/socket\");\r\n    const socket = io();\r\n    socket.on(\"connect\", () => {\r\n      console.log(`user ${user.uid} connect`);\r\n    });\r\n    setSock(socket);\r\n    return () =>\r\n      socket.on(\"disconnect\", () => {\r\n        console.log(`user ${user.uid} disconnect`);\r\n      });\r\n  }, []);\r\n  return <TimerInternal socket={sock} user={user} alumno={alumno} />;\r\n}\r\n\r\n\r\nfunction TimerInternal({ socket,user,alumno}) {\r\n  const dispatch = useDispatch()\r\n  const { enqueueSnackbar } = useSnackbar();\r\n  const [seconds, setSeconds] = useState(alumno?.data?.time);\r\n  const [timer, setTimer] = useState({ h: null, m: null, s: null });\r\n\r\n  useEffect(() => {\r\n    let interval = null;\r\n    if(seconds ===900){\r\n      enqueueSnackbar(\"Quedan 15 minutos para finalizar\", {\r\n        variant: \"warning\",\r\n      });\r\n    }\r\n    if(seconds === 0){\r\n\r\n      enqueueSnackbar(\"El tiempo para realizar tu examen finalizo\", {\r\n        variant: \"info\",\r\n      });\r\n      setSeconds(0);\r\n      dispatch(accionTime(0))\r\n      setTimer({\r\n        s: 0,\r\n        h: 0,\r\n        m: 0,\r\n      });\r\n      socket?.emit(\"message\", { id: user.uid, time: seconds });\r\n      allCancel({id:user?.uid}).then(()=>{\r\n        window.location.replace('/home')\r\n      })\r\n    }else{\r\n      interval = setInterval(() => {\r\n        setSeconds((seconds) => seconds - 1);\r\n      }, 1000);\r\n      dispatch(accionTime(seconds))\r\n      setTimer({\r\n        s: Math.round(seconds % 0x3c),\r\n        h: Math.floor(seconds / 0xe10),\r\n        m: Math.floor(seconds / 0x3c) % 0x3c,\r\n      });\r\n      socket?.emit(\"message\", { id: user.uid, time: seconds });\r\n    }\r\n    return () => clearInterval(interval);\r\n  }, [seconds]);\r\n\r\n  return (\r\n    <>\r\n      <AccessAlarmIcon />\r\n      {`${timer.h}H ${timer.m} M ${timer.s}S`}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default RelojLimit;\r\n"]},"metadata":{},"sourceType":"module"}