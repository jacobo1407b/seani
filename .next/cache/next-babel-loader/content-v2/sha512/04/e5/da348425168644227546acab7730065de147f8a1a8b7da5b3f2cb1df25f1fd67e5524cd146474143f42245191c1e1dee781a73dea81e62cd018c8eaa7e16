{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\proyectos\\\\next\\\\seani\\\\components\\\\Reloj\\\\RelojLimit.jsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport io from \"socket.io-client\";\nimport { useSnackbar } from \"notistack\";\nimport { useDispatch } from 'react-redux';\nimport { accionTime } from '../../redux/accion';\nimport AccessAlarmIcon from \"@material-ui/icons/AccessAlarm\";\nimport { allCancel } from '../../utils/api';\n\nfunction RelojLimit(_ref) {\n  _s();\n\n  var user = _ref.user,\n      alumno = _ref.alumno;\n\n  var _useState = useState(null),\n      sock = _useState[0],\n      setSock = _useState[1];\n\n  useEffect(function () {\n    fetch(\"/api/socket\");\n    var socket = io();\n    socket.on(\"connect\", function () {\n      console.log(\"user \".concat(user.uid, \" connect\"));\n    });\n    setSock(socket);\n    return function () {\n      return socket.on(\"disconnect\", function () {\n        console.log(\"user \".concat(user.uid, \" disconnect\"));\n      });\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(TimerInternal, {\n    socket: sock,\n    user: user,\n    alumno: alumno\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 25,\n    columnNumber: 10\n  }, this);\n}\n\n_s(RelojLimit, \"W9rPSv2JROYYlJF6ajOP+3W0JM0=\");\n\n_c = RelojLimit;\n\nfunction TimerInternal(_ref2) {\n  _s2();\n\n  var _alumno$data;\n\n  var socket = _ref2.socket,\n      user = _ref2.user,\n      alumno = _ref2.alumno;\n  var dispatch = useDispatch();\n\n  var _useSnackbar = useSnackbar(),\n      enqueueSnackbar = _useSnackbar.enqueueSnackbar;\n\n  var _useState2 = useState(alumno === null || alumno === void 0 ? void 0 : (_alumno$data = alumno.data) === null || _alumno$data === void 0 ? void 0 : _alumno$data.time),\n      seconds = _useState2[0],\n      setSeconds = _useState2[1];\n\n  var _useState3 = useState({\n    h: null,\n    m: null,\n    s: null\n  }),\n      timer = _useState3[0],\n      setTimer = _useState3[1];\n\n  useEffect(function () {\n    var interval = null;\n\n    if (seconds === 900) {\n      enqueueSnackbar(\"Quedan 15 minutos para finalizar\", {\n        variant: \"warning\"\n      });\n    }\n\n    if (seconds === 0) {\n      enqueueSnackbar(\"El tiempo para realizar tu examen finalizo\", {\n        variant: \"info\"\n      });\n      setSeconds(0);\n      dispatch(accionTime(0));\n      setTimer({\n        s: 0,\n        h: 0,\n        m: 0\n      });\n      socket === null || socket === void 0 ? void 0 : socket.emit(\"message\", {\n        id: user.uid,\n        time: seconds\n      });\n      allCancel({\n        id: user === null || user === void 0 ? void 0 : user.uid\n      }).then(function () {\n        window.location.replace('/home');\n      });\n    } else {\n      interval = setInterval(function () {\n        setSeconds(function (seconds) {\n          return seconds - 1;\n        });\n      }, 1000);\n      dispatch(accionTime(seconds));\n      setTimer({\n        s: Math.round(seconds % 0x3c),\n        h: Math.floor(seconds / 0xe10),\n        m: Math.floor(seconds / 0x3c) % 0x3c\n      });\n      socket === null || socket === void 0 ? void 0 : socket.emit(\"message\", {\n        id: user.uid,\n        time: seconds\n      });\n    }\n\n    return function () {\n      return clearInterval(interval);\n    };\n  }, [seconds]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(AccessAlarmIcon, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this), \"\".concat(timer.h, \"H \").concat(timer.m, \" M \").concat(timer.s, \"S\")]\n  }, void 0, true);\n}\n\n_s2(TimerInternal, \"R9bDoygyPf1Op5m2YihFMvS1fU4=\", false, function () {\n  return [useDispatch, useSnackbar];\n});\n\n_c2 = TimerInternal;\nexport default RelojLimit;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"RelojLimit\");\n$RefreshReg$(_c2, \"TimerInternal\");","map":{"version":3,"sources":["C:/proyectos/next/seani/components/Reloj/RelojLimit.jsx"],"names":["React","useState","useEffect","io","useSnackbar","useDispatch","accionTime","AccessAlarmIcon","allCancel","RelojLimit","user","alumno","sock","setSock","fetch","socket","on","console","log","uid","TimerInternal","dispatch","enqueueSnackbar","data","time","seconds","setSeconds","h","m","s","timer","setTimer","interval","variant","emit","id","then","window","location","replace","setInterval","Math","round","floor","clearInterval"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport io from \"socket.io-client\";\r\nimport { useSnackbar } from \"notistack\";\r\nimport {useDispatch} from 'react-redux'\r\nimport {accionTime} from '../../redux/accion'\r\nimport AccessAlarmIcon from \"@material-ui/icons/AccessAlarm\";\r\nimport {allCancel} from '../../utils/api';\r\n\r\n\r\n\r\nfunction RelojLimit({ user,alumno }) {\r\n  const [sock, setSock] = useState(null);\r\n  useEffect(() => {\r\n    fetch(\"/api/socket\");\r\n    const socket = io();\r\n    socket.on(\"connect\", () => {\r\n      console.log(`user ${user.uid} connect`);\r\n    });\r\n    setSock(socket);\r\n    return () =>\r\n      socket.on(\"disconnect\", () => {\r\n        console.log(`user ${user.uid} disconnect`);\r\n      });\r\n  }, []);\r\n  return <TimerInternal socket={sock} user={user} alumno={alumno} />;\r\n}\r\n\r\n\r\nfunction TimerInternal({ socket,user,alumno}) {\r\n  const dispatch = useDispatch()\r\n  const { enqueueSnackbar } = useSnackbar();\r\n  const [seconds, setSeconds] = useState(alumno?.data?.time);\r\n  const [timer, setTimer] = useState({ h: null, m: null, s: null });\r\n\r\n  useEffect(() => {\r\n    let interval = null;\r\n    if(seconds ===900){\r\n      enqueueSnackbar(\"Quedan 15 minutos para finalizar\", {\r\n        variant: \"warning\",\r\n      });\r\n    }\r\n    if(seconds === 0){\r\n\r\n      enqueueSnackbar(\"El tiempo para realizar tu examen finalizo\", {\r\n        variant: \"info\",\r\n      });\r\n      setSeconds(0);\r\n      dispatch(accionTime(0))\r\n      setTimer({\r\n        s: 0,\r\n        h: 0,\r\n        m: 0,\r\n      });\r\n      socket?.emit(\"message\", { id: user.uid, time: seconds });\r\n      allCancel({id:user?.uid}).then(()=>{\r\n        window.location.replace('/home')\r\n      })\r\n    }else{\r\n      interval = setInterval(() => {\r\n        setSeconds((seconds) => seconds - 1);\r\n      }, 1000);\r\n      dispatch(accionTime(seconds))\r\n      setTimer({\r\n        s: Math.round(seconds % 0x3c),\r\n        h: Math.floor(seconds / 0xe10),\r\n        m: Math.floor(seconds / 0x3c) % 0x3c,\r\n      });\r\n      socket?.emit(\"message\", { id: user.uid, time: seconds });\r\n    }\r\n    return () => clearInterval(interval);\r\n  }, [seconds]);\r\n\r\n  return (\r\n    <>\r\n      <AccessAlarmIcon />\r\n      {`${timer.h}H ${timer.m} M ${timer.s}S`}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default RelojLimit;\r\n"]},"metadata":{},"sourceType":"module"}